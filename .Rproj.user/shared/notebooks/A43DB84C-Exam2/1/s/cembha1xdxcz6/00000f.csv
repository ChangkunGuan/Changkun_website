"0","p.val = function(statistic, perm_distribution, alternative) {"
"0","  if (alternative == ""less"") {"
"0","    p_value = sum(perm_distribution <= statistic) / length(perm_distribution)"
"0","  } else if (alternative == ""greater"") {"
"0","    p_value = sum(perm_distribution >= statistic) / length(perm_distribution)"
"0","  } else if (alternative == ""two.sided"") {"
"0","    extreme_stat = max(abs(statistic - mean(perm_distribution)), abs(statistic + mean(perm_distribution)))"
"0","    p_value = sum(abs(perm_distribution - mean(perm_distribution)) >= extreme_stat) / length(perm_distribution)"
"0","  } else {"
"0","    stop(""Invalid alternative hypothesis. Please use 'less', 'greater', or 'two.sided'."")"
"0","  }"
"0","  "
"0","  return(p_value)"
"0","}"
"0",""
